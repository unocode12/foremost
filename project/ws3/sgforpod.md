# ğŸ”’ EKS Security Groups for Pods ê¸°ìˆ  ì •ë¦¬

## ğŸ“‹ ëª©ì°¨

1. [ë°°ê²½](#1-ë°°ê²½)
2. [Security Groups for Pods ê°œë…](#2-security-groups-for-pods-ê°œë…)
3. [ë„¤íŠ¸ì›Œí¬ ë™ì‘ êµ¬ì¡°](#3-ë„¤íŠ¸ì›Œí¬-ë™ì‘-êµ¬ì¡°)
4. [í•µì‹¬ êµ¬ì„± ìš”ì†Œ](#4-í•µì‹¬-êµ¬ì„±-ìš”ì†Œ)
5. [ë™ì‘ íë¦„](#5-ë™ì‘-íë¦„-pod-ìƒì„±-ì‹œì )
6. [IAM ë° ê¶Œí•œ ìš”êµ¬ì‚¬í•­](#6-iam-ë°-ê¶Œí•œ-ìš”êµ¬ì‚¬í•­)
7. [NetworkPolicyì™€ì˜ ê¸°ìˆ ì  ì°¨ì´](#7-networkpolicyì™€ì˜-ê¸°ìˆ ì -ì°¨ì´)
8. [Fargateì™€ì˜ ê´€ê³„](#8-fargateì™€ì˜-ê´€ê³„)
9. [ì„±ëŠ¥ ë° ì œí•œì‚¬í•­](#9-ì„±ëŠ¥-ë°-ì œí•œì‚¬í•­)
10. [ëŒ€í‘œì ì¸ ì‚¬ìš© ì‚¬ë¡€](#10-ëŒ€í‘œì ì¸-ì‚¬ìš©-ì‚¬ë¡€)
11. [ìš”ì•½](#11-ìš”ì•½)
12. [íŠ¸ë˜í”½ íë¦„ ë³€í™” ë¹„êµ](#12-íŠ¸ë˜í”½-íë¦„-ë³€í™”-ë¹„êµ)

---

## 1. ë°°ê²½

### ğŸ” ë¬¸ì œ ìƒí™©

ê¸°ë³¸ì ì¸ Kubernetes í™˜ê²½(EKS í¬í•¨)ì—ì„œëŠ” **Security Group(SG)**ì´ ë…¸ë“œ(EC2)ì—ë§Œ ì ìš©ë©ë‹ˆë‹¤. PodëŠ” ë…¸ë“œì˜ ë„¤íŠ¸ì›Œí¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë˜ëŠ” CNIê°€ í• ë‹¹í•œ IPë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ, **ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ í†µì œëŠ” ë…¸ë“œ ë‹¨ìœ„**ë¡œë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### âŒ ê¸°ì¡´ êµ¬ì¡°ì˜ í•œê³„

- ğŸ”´ ì„œë¡œ ë‹¤ë¥¸ ì„±ê²©ì˜ Podê°€ ë™ì¼í•œ SG ê·œì¹™ì„ ê³µìœ 
- ğŸ”´ íŠ¹ì • Podë§Œ RDS, ElastiCache ë“± AWS ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ ì œì–´ ë¶ˆê°€
- ğŸ”´ ë©€í‹° í…Œë„Œì‹œ, ë³´ì•ˆ ìš”êµ¬ì‚¬í•­ì´ ë†’ì€ í™˜ê²½ì—ì„œ í•œê³„ ë°œìƒ

### âœ… í•´ê²°ì±…

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ AWSëŠ” **Security Groups for Pods** ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## 2. Security Groups for Pods ê°œë…

### ğŸ¯ ì •ì˜

**Security Groups for Pods**ëŠ” Pod ë‹¨ìœ„ë¡œ AWS Security Groupì„ ì§ì ‘ í• ë‹¹í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

### ğŸ’¡ í•µì‹¬ ì•„ì´ë””ì–´

- ğŸ¯ Podë§ˆë‹¤ **ì „ìš© ENI(Elastic Network Interface)** í• ë‹¹
- ğŸ” í•´ë‹¹ ENIì— **Pod ì „ìš© Security Group ì—°ê²°**
- ğŸŒ Podê°€ VPC ë„¤íŠ¸ì›Œí¬ ìƒì—ì„œ **ë…ë¦½ì ì¸ ë„¤íŠ¸ì›Œí¬ ì—”ë“œí¬ì¸íŠ¸**ë¡œ ë™ì‘

> **í•µì‹¬**: Podê°€ AWS VPC ê´€ì ì—ì„œ EC2, RDSì™€ ë™ì¼í•œ **ë„¤íŠ¸ì›Œí¬ 1ê¸‰ ì‹œë¯¼(first-class citizen)**ì´ ë©ë‹ˆë‹¤.

---

## 3. ë„¤íŠ¸ì›Œí¬ ë™ì‘ êµ¬ì¡°

### ğŸ“Š ê¸°ì¡´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod 1  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Pod 2  â”‚â”€â”€â”€â”€â”€â”¤  Node ENI    â”‚â”€â”€â”€ Security Group (Node SG)
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
â”‚  Pod 3  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**íŠ¹ì§•**:
- ëª¨ë“  Pod íŠ¸ë˜í”½ì€ Node ENIë¥¼ í†µí•´ ì†¡ìˆ˜ì‹ 
- Node SGê°€ ëª¨ë“  Pod íŠ¸ë˜í”½ì„ í†µì œ

---

### âœ¨ Security Groups for Pods ì ìš© í›„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pod A   â”‚â”€â”€â”€â”€â”€â”¤ ENI A   â”‚â”€â”€â”€â”€â”€â”¤  SG A   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Pod B   â”‚â”€â”€â”€â”€â”€â”¤ ENI B   â”‚â”€â”€â”€â”€â”€â”¤  SG B   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**íŠ¹ì§•**:
- âœ… Podë§ˆë‹¤ ë³„ë„ì˜ ENIì™€ Private IP í• ë‹¹
- âœ… Pod ë‹¨ìœ„ë¡œ Inbound / Outbound SG ê·œì¹™ ì ìš©
- âœ… SG ê°„ ì°¸ì¡° ê°€ëŠ¥ (ì˜ˆ: Pod SG â†’ RDS SG)

---

## 4. í•µì‹¬ êµ¬ì„± ìš”ì†Œ

### 4.1 AWS VPC CNI

**Amazon VPC Container Network Interface Plugin**

Amazon EKSëŠ” VPC CNIë¼ê³ ë„ í•˜ëŠ” Amazon VPC ì»¨í…Œì´ë„ˆ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ í´ëŸ¬ìŠ¤í„° ë„¤íŠ¸ì›Œí‚¹ì„ êµ¬í˜„í•©ë‹ˆë‹¤.

**ì£¼ìš” íŠ¹ì§•**:
- CNI í”ŒëŸ¬ê·¸ì¸ì„ ì‚¬ìš©í•˜ë©´ Kubernetes Podê°€ VPC ë„¤íŠ¸ì›Œí¬ì—ì„œì™€ ë™ì¼í•œ IP ì£¼ì†Œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤
- Pod ë‚´ì˜ ëª¨ë“  ì»¨í…Œì´ë„ˆëŠ” ë„¤íŠ¸ì›Œí¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ê³µìœ í•˜ë©° ë¡œì»¬ í¬íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¡œ í†µì‹ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

**ìš”êµ¬ì‚¬í•­**:
- `amazon-vpc-cni-k8s` í”ŒëŸ¬ê·¸ì¸ í•„ìš”
- Podì— Secondary IP ë˜ëŠ” Branch ENI í• ë‹¹
- Security Group for PodsëŠ” **Branch ENI ê¸°ë°˜**ìœ¼ë¡œ ë™ì‘

---

### 4.2 Branch ENI

**Elastic Network Interface (Branch)**

- ğŸ”Œ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°ë˜ëŠ” ë³´ì¡° ENI
- ğŸ¯ Pod ì „ìš© ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ ì—­í• 
- ğŸ” ê°ê° ê³ ìœ í•œ Security Group ì—°ê²° ê°€ëŠ¥

---

### 4.3 SecurityGroupPolicy CRD

AWSì—ì„œ ì œê³µí•˜ëŠ” Kubernetes CRDë¡œ, Pod Selectorì™€ Security Groupì„ ë§¤í•‘í•©ë‹ˆë‹¤.

**ì˜ˆì‹œ**:

```yaml
apiVersion: vpcresources.k8s.aws/v1beta1
kind: SecurityGroupPolicy
metadata:
  name: pod-db-access
spec:
  podSelector:
    matchLabels:
      app: backend
  securityGroups:
    groupIds:
      - sg-0abc123456789
```

**ì„¤ëª…**:
- `podSelector`: ëŒ€ìƒ Pod ì„ íƒ (ë¼ë²¨ ê¸°ë°˜)
- `groupIds`: ì ìš©í•  Security Group ID ëª©ë¡

---

## 5. ë™ì‘ íë¦„ (Pod ìƒì„± ì‹œì )

### ğŸ”„ Pod ìƒì„± í”„ë¡œì„¸ìŠ¤

```mermaid
graph TD
    A[Pod ìƒì„± ìš”ì²­] --> B[VPC CNIê°€ Pod ë¼ë²¨ í™•ì¸]
    B --> C[ë§¤ì¹­ë˜ëŠ” SecurityGroupPolicy ê²€ìƒ‰]
    C --> D[Branch ENI ìƒì„± ë˜ëŠ” í• ë‹¹]
    D --> E[ENIì— ì§€ì •ëœ Security Group ì—°ê²°]
    E --> F[Podì— ENIì˜ Private IP í• ë‹¹]
    F --> G[Pod ë„¤íŠ¸ì›Œí¬ í™œì„±í™”]
```

**ë‹¨ê³„ë³„ ì„¤ëª…**:

1. ğŸ“ **Pod ìƒì„± ìš”ì²­**: Kubernetes API Serverì— Pod ìƒì„± ìš”ì²­
2. ğŸ·ï¸ **ë¼ë²¨ í™•ì¸**: VPC CNIê°€ Podì˜ ë¼ë²¨ í™•ì¸
3. ğŸ” **Policy ê²€ìƒ‰**: ë§¤ì¹­ë˜ëŠ” SecurityGroupPolicy ê²€ìƒ‰
4. ğŸ”Œ **ENI ìƒì„±**: Branch ENI ìƒì„± ë˜ëŠ” ê¸°ì¡´ ENI í• ë‹¹
5. ğŸ” **SG ì—°ê²°**: ENIì— ì§€ì •ëœ Security Group ì—°ê²°
6. ğŸŒ **IP í• ë‹¹**: Podì— ENIì˜ Private IP í• ë‹¹
7. âœ… **í™œì„±í™”**: Pod ë„¤íŠ¸ì›Œí¬ í™œì„±í™” ì™„ë£Œ

---

## 6. IAM ë° ê¶Œí•œ ìš”êµ¬ì‚¬í•­

### ğŸ”‘ í•„ìˆ˜ ìš”êµ¬ì‚¬í•­

Security Groups for PodsëŠ” AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì§ì ‘ ìƒì„±/ì œì–´í•˜ë¯€ë¡œ **IRSA(IAM Role for Service Account)**ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤.

### ğŸ“‹ í•„ìš” ê¶Œí•œ

ë‹¤ìŒ EC2 ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤:

| ê¶Œí•œ | ì„¤ëª… |
|------|------|
| `ec2:CreateNetworkInterface` | Branch ENI ìƒì„± |
| `ec2:AttachNetworkInterface` | ENIë¥¼ ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²° |
| `ec2:DeleteNetworkInterface` | ENI ì‚­ì œ |
| `ec2:DescribeNetworkInterfaces` | ENI ì •ë³´ ì¡°íšŒ |
| `ec2:ModifyNetworkInterfaceAttribute` | ENI ì†ì„± ìˆ˜ì • (SG ë³€ê²½) |

**ì˜ˆì‹œ IAM Policy**:

```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface",
        "ec2:AttachNetworkInterface",
        "ec2:DeleteNetworkInterface",
        "ec2:DescribeNetworkInterfaces",
        "ec2:ModifyNetworkInterfaceAttribute"
      ],
      "Resource": "*"
    }
  ]
}
```

---

## 7. NetworkPolicyì™€ì˜ ê¸°ìˆ ì  ì°¨ì´

### ğŸ“Š ë¹„êµí‘œ

| í•­ëª© | Security Groups for Pods | Kubernetes NetworkPolicy |
|------|-------------------------|-------------------------|
| **ì œì–´ ìœ„ì¹˜** | AWS VPC | CNI ë‚´ë¶€ |
| **ê³„ì¸µ** | L3 / L4 | L3 / L4 |
| **AWS ë¦¬ì†ŒìŠ¤ ì œì–´** | âœ… ë§¤ìš° ê°•í•¨ | âŒ ì œí•œì  |
| **SG ì°¸ì¡°** | âœ… ê°€ëŠ¥ | âŒ ë¶ˆê°€ |
| **í´ë¼ìš°ë“œ ì¢…ì†ì„±** | AWS ì¢…ì† | ì´ì‹ì„± ë†’ìŒ |
| **ì„±ëŠ¥** | VPC ë ˆë²¨ (ê³ ì„±ëŠ¥) | CNI ë ˆë²¨ |

### ğŸ¯ ê¶Œì¥ ì „ëµ

- **AWS ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ ì œì–´**: ğŸ” Security Groups for Pods
- **Pod â†” Pod í†µì‹  ì œì–´**: ğŸŒ NetworkPolicy

> **Tip**: ë‘ ê¸°ìˆ ì„ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ë‹¤ì¸µ ë°©ì–´ ì „ëµì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## 8. Fargateì™€ì˜ ê´€ê³„

### ğŸš€ EKS Fargate

- âœ… EKS FargateëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Pod ë‹¨ìœ„ ENI ì‚¬ìš©
- âœ… ë”°ë¼ì„œ Security Group ê°œë…ì´ ìì—°ìŠ¤ëŸ½ê²Œ Pod ë‹¨ìœ„ë¡œ ì ìš©ë¨
- âš ï¸ EC2 ê¸°ë°˜ EKSì—ì„œëŠ” ëª…ì‹œì ìœ¼ë¡œ Security Groups for Pods ì„¤ì • í•„ìš”

**ë¹„êµ**:

| í”Œë«í¼ | Pod ë‹¨ìœ„ ENI | SG for Pods ì„¤ì • |
|--------|-------------|-----------------|
| **EKS Fargate** | âœ… ê¸°ë³¸ ì œê³µ | ìë™ ì ìš© |
| **EKS (EC2)** | âŒ ê¸°ë³¸ ì•„ë‹˜ | ëª…ì‹œì  ì„¤ì • í•„ìš” |

---

## 9. ì„±ëŠ¥ ë° ì œí•œì‚¬í•­

### âš ï¸ ENI ì œí•œ

- ğŸ”¢ EC2 ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ë³„ ENI ê°œìˆ˜ ì œí•œ ì¡´ì¬
- ğŸ“ˆ ëŒ€ëŸ‰ Pod í™˜ê²½ì—ì„œ í™•ì¥ì„± ê³ ë ¤ í•„ìš”

**ì˜ˆì‹œ** (ì¼ë¶€ ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…):
- `t3.medium`: ìµœëŒ€ 3ê°œ ENI
- `m5.large`: ìµœëŒ€ 3ê°œ ENI
- `c5.xlarge`: ìµœëŒ€ 4ê°œ ENI

### ğŸŒ IP ì†Œëª¨

- ğŸ“ Podë§ˆë‹¤ Private IP ì‚¬ìš©
- ğŸ¯ CIDR í¬ê¸° ì„¤ê³„ ì¤‘ìš”

**ê³ ë ¤ì‚¬í•­**:
- ì„œë¸Œë„· CIDR ë¸”ë¡ í¬ê¸° ê³„íš
- IP ì£¼ì†Œ ë¶€ì¡± ì‹œ ì„œë¸Œë„· í™•ì¥ í•„ìš”

### ğŸ’° ë¹„ìš©

- âœ… ENI ìì²´ ë¹„ìš©ì€ ì—†ìŒ
- âš ï¸ IP ë¶€ì¡± ì‹œ ì„œë¸Œë„· í™•ì¥ í•„ìš” ê°€ëŠ¥

---

## 10. ëŒ€í‘œì ì¸ ì‚¬ìš© ì‚¬ë¡€

### ğŸ¯ ì£¼ìš” ì‚¬ìš© ì‚¬ë¡€

1. **ğŸ” Backend Pod â†’ RDS ì ‘ê·¼ ì œì–´**
   - íŠ¹ì • Podë§Œ RDSì— ì ‘ê·¼ í—ˆìš©
   - ì„¸ë°€í•œ ë°ì´í„°ë² ì´ìŠ¤ ë³´ì•ˆ ì •ì±… ì ìš©

2. **ğŸŒ íŠ¹ì • Podë§Œ ì™¸ë¶€ ì¸í„°ë„· ì ‘ê·¼ í—ˆìš©**
   - ì¸í„°ë„· ì ‘ê·¼ì´ í•„ìš”í•œ Podë§Œ ì„ íƒì  í—ˆìš©
   - ë³´ì•ˆ ì •ì±… ê°•í™”

3. **ğŸ¢ ë©€í‹° í…Œë„Œì‹œ í™˜ê²½ì—ì„œ Pod ë‹¨ìœ„ ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬**
   - í…Œë„ŒíŠ¸ë³„ ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬
   - ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ ì œì–´

4. **ğŸ“‹ ë³´ì•ˆ ê°ì‚¬ ìš”êµ¬ì‚¬í•­ ëŒ€ì‘**
   - Pod ë‹¨ìœ„ íŠ¸ë˜í”½ ì¶”ì 
   - ìƒì„¸í•œ ë³´ì•ˆ ë¡œê·¸ ìˆ˜ì§‘

---

## 11. ìš”ì•½

### âœ… í•µì‹¬ í¬ì¸íŠ¸

- ğŸ¯ Security Groups for PodsëŠ” Podë¥¼ AWS VPC ë„¤íŠ¸ì›Œí¬ì˜ ë…ë¦½ ì—”ë“œí¬ì¸íŠ¸ë¡œ ë§Œë“­ë‹ˆë‹¤
- ğŸ”“ Node ë‹¨ìœ„ SGì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³  Pod ë‹¨ìœ„ ë³´ì•ˆ í†µì œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤
- ğŸ† AWS ë¦¬ì†ŒìŠ¤ ì—°ê³„ ë³´ì•ˆì´ ì¤‘ìš”í•œ ê²½ìš° ì‚¬ì‹¤ìƒ í‘œì¤€ì ì¸ ì„ íƒì…ë‹ˆë‹¤

### ğŸ’¬ í•œ ì¤„ ìš”ì•½

> **Security Groups for Pods = Kubernetes Podì— AWS Security Groupì„ ì§ì ‘ ì ìš©í•˜ëŠ” VPC ë„¤ì´í‹°ë¸Œ ë³´ì•ˆ ê¸°ëŠ¥**

---

## 12. íŠ¸ë˜í”½ íë¦„ ë³€í™” ë¹„êµ

### ğŸ“Š [1] ì „ì²´ ê°œë… ë¹„êµ

| êµ¬ë¶„ | ê¸°ì¡´ (Node SG) | Security Groups for Pods |
|------|---------------|-------------------------|
| **ë„¤íŠ¸ì›Œí¬ ì¢…ì°©ì§€** | Node ENI | Pod ENI |
| **SG í‰ê°€ ìœ„ì¹˜** | Node ENI | Pod ENI |
| **ë³´ì•ˆ ì œì–´ ë‹¨ìœ„** | Node | Pod |
| **Pod ì „ìš© SG** | âŒ ë¶ˆê°€ëŠ¥ | âœ… ê°€ëŠ¥ |
| **Node ê²½ìœ  (DataPath)** | í•­ìƒ ê²½ìœ  | ìš°íšŒ ê°€ëŠ¥ |
| **VPC ê´€ì  ì—”ë“œí¬ì¸íŠ¸** | Node | Pod |

**í•µì‹¬ ìš”ì•½**:
- Kubernetes êµ¬ì¡°ëŠ” ë™ì¼
- VPC ë ˆë²¨ì—ì„œ íŠ¸ë˜í”½ ì¢…ì°©ì§€ê°€ **Node â†’ Pod**ë¡œ ì´ë™

---

### ğŸ“¥ [2] ì™¸ë¶€ â†’ Pod (Ingress) íŠ¸ë˜í”½ íë¦„

| í•­ëª© | ê¸°ì¡´ ë°©ì‹ | SG for Pods |
|------|----------|-------------|
| **ALB Target** | Node IP | Pod IP |
| **ì¤‘ê°„ ê²½ë¡œ** | ALB â†’ Node â†’ kube-proxy â†’ Pod | ALB â†’ Pod |
| **SG ê²€ì‚¬ ì§€ì ** | Node SG | Pod SG |
| **í—¬ìŠ¤ì²´í¬ ëŒ€ìƒ** | NodePort | Pod Port |
| **ë„¤íŠ¸ì›Œí¬ í™‰ ìˆ˜** | ë§ìŒ | ì ìŒ |

**íŠ¸ë˜í”½ íë¦„ ë¹„êµ**:

```
ê¸°ì¡´: Client â†’ ALB â†’ Node â†’ Pod
ë³€ê²½: Client â†’ ALB â†’ Pod
```

**ì¥ì **:
- âœ… ë„¤íŠ¸ì›Œí¬ í™‰ ê°ì†Œë¡œ ì§€ì—° ì‹œê°„ ë‹¨ì¶•
- âœ… ì§ì ‘ì ì¸ Pod ë ˆë²¨ ë³´ì•ˆ ì œì–´

---

### ğŸ“¤ [3] Pod â†’ ì™¸ë¶€ (Egress) íŠ¸ë˜í”½ íë¦„

| í•­ëª© | ê¸°ì¡´ | SG for Pods |
|------|-----|-------------|
| **Source IP** | Node IP (SNAT ë°œìƒ) | Pod IP ìœ ì§€ |
| **Egress SG ì œì–´** | Node ë‹¨ìœ„ | Pod ë‹¨ìœ„ |
| **ì™¸ë¶€ ë¡œê·¸ ê¸°ì¤€** | Node ê¸°ì¤€ | Pod ê¸°ì¤€ |
| **RDS ì ‘ê·¼ ì œì–´** | ê°„ì ‘/ë¶ˆëª…í™• | ì •í™• |

**í•µì‹¬ ë³€í™”**:
- âœ… Podê°€ ì§ì ‘ ì™¸ë¶€ì™€ í†µì‹ 
- âœ… ë³´ì•ˆ ê°ì‚¬ ë° íŠ¸ë˜í”½ ì¶”ì  ìš©ì´
- âœ… SNAT ì œê±°ë¡œ Source IP ì¶”ì  ê°€ëŠ¥

---

### ğŸ”„ [4] Pod â†” Pod í†µì‹ 

| í†µì‹  ìœ í˜• | ì‹¤ì œ ê²½ë¡œ | SG ì˜í–¥ |
|----------|---------|---------|
| **ê°™ì€ ë…¸ë“œ** | veth â†” veth | ì—†ìŒ |
| **ë‹¤ë¥¸ ë…¸ë“œ** | Pod ENI â†’ VPC â†’ Pod ENI | ìˆìŒ |
| **SG í‰ê°€** | ê¸°ì¡´: ì—†ìŒ | Ingress + Egress |

**ì°¸ê³ **:
- NetworkPolicyì™€ ë³‘í–‰ ê°€ëŠ¥
- ê°™ì€ ë…¸ë“œ ë‚´ í†µì‹ ì€ ì—¬ì „íˆ íš¨ìœ¨ì 

---

### ğŸ—ï¸ [5] Kubernetes ë ˆì´ì–´ ê´€ì  ë³€í™” ì—¬ë¶€

| ë ˆì´ì–´ | ë³€í™” ì—¬ë¶€ | ì„¤ëª… |
|--------|----------|------|
| **Ingress Controller** | âŒ ì—†ìŒ | ë™ì¼ |
| **Service** | âŒ ì—†ìŒ | ClusterIP / NodePort ë™ì¼ |
| **kube-proxy** | âš ï¸ ë…¼ë¦¬ ìœ ì§€ | ë°ì´í„° íŒ¨ìŠ¤ ê°ì†Œ ê°€ëŠ¥ |
| **L7 ë¼ìš°íŒ…** | âŒ ì—†ìŒ | HTTP/gRPC ë™ì¼ |
| **L3/L4 ë°ì´í„° í”Œë ˆì¸** | âœ… ë³€ê²½ë¨ | VPC ë ˆë²¨ ê²½ë¡œ ë³€ê²½ |

**ì„¤ëª…**:
- ìƒìœ„ ë ˆì´ì–´ (Service, Ingress)ëŠ” ë³€ê²½ ì—†ìŒ
- í•˜ìœ„ ë ˆì´ì–´ (VPC ë°ì´í„° í”Œë ˆì¸)ë§Œ ë³€ê²½

---

### ğŸ“ [6] í•œ ë¬¸ì¥ ìš”ì•½ ëª¨ìŒ

1. âœ… Service íë¦„ì€ ë°”ë€Œì§€ ì•ŠëŠ”ë‹¤.
2. ğŸ¯ íŠ¸ë˜í”½ ì¢…ì°©ì§€ëŠ” Nodeì—ì„œ Podë¡œ ì´ë™í•œë‹¤.
3. ğŸ” Security Group í‰ê°€ ì§€ì ì´ Pod ENIë¡œ ì´ë™í•œë‹¤.
4. ğŸšª NodeëŠ” ë” ì´ìƒ ë°ì´í„° íŠ¸ë˜í”½ì˜ ê´€ë¬¸ì´ ì•„ë‹ˆë‹¤.
5. ğŸŒ Podê°€ VPC ë„¤íŠ¸ì›Œí¬ì˜ ì§ì ‘ ì—”ë“œí¬ì¸íŠ¸ê°€ ëœë‹¤.

---

### ğŸ¯ [ìµœì¢… í•œ ì¤„ ìš”ì•½]

> **Security Groups for Podsë¥¼ ì‚¬ìš©í•˜ë©´ Kubernetes êµ¬ì¡°ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ë˜ì§€ë§Œ, VPC ê´€ì ì—ì„œ íŠ¸ë˜í”½ ê²½ë¡œì™€ ë³´ì•ˆ í†µì œì˜ ì¤‘ì‹¬ì´ Nodeì—ì„œ Podë¡œ ì´ë™í•œë‹¤.**

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [AWS ê³µì‹ ë¬¸ì„œ - Security Groups for Pods](https://docs.aws.amazon.com/eks/latest/userguide/security-groups-for-pods.html)
- [AWS VPC CNI Plugin](https://github.com/aws/amazon-vpc-cni-k8s)
- [Kubernetes Network Policies](https://kubernetes.io/docs/concepts/services-networking/network-policies/)

---
